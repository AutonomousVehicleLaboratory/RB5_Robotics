
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="RB5 ROBOTICS TUTORIALS">
    <title>Tag: usb - RB5 ROBOTICS TUTORIALS</title>
    <meta name="author" content="RB5 ROBOTICS TUTORIALS">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta name="description" content="Some description for subtitle">
<meta property="og:type" content="blog">
<meta property="og:title" content="RB5 ROBOTICS TUTORIALS">
<meta property="og:url" content="https://autonomousvehiclelaboratory.github.io/RB5_Robotics_Tutorials/tags/usb/index.html">
<meta property="og:site_name" content="RB5 ROBOTICS TUTORIALS">
<meta property="og:description" content="Some description for subtitle">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="RB5 ROBOTICS TUTORIALS">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://autonomousvehiclelaboratory.github.io/RB5_Robotics_Tutorials/assets/images/avl-letters.png"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/RB5_Robotics_Tutorials/assets/css/style-64qguiewfoxvxmp0xtsq6t9zwhtgymxalbr3hofnf6gpcss5mvrocwased14.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/RB5_Robotics_Tutorials/"
            aria-label=""
        >
            RB5 ROBOTICS TUTORIALS
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /RB5_Robotics_Tutorials/#about"
            >
        
        
            <img class="header-picture" src="/RB5_Robotics_Tutorials/assets/images/avl-letters.png" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/RB5_Robotics_Tutorials/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/RB5_Robotics_Tutorials/assets/images/avl-letters.png" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">RB5 ROBOTICS TUTORIALS</h4>
                
                    <h5 class="sidebar-profile-bio"><p>A set of Robotics Tutorials developed for the RB5 Robotics Development Platform from Qualcomm. Authors are from the Contextual Robotics Institute at UC San Diego.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/RB5_Robotics_Tutorials/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/RB5_Robotics_Tutorials/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/RB5_Robotics_Tutorials/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/AutonomousVehicleLaboratory"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:avl@eng.ucsd.edu"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/RB5_Robotics_Tutorials/2022/05/22/3%20Robotics%20Applications/control-example-interface/"
                            aria-label=": (4) Control - An example interface using the Megabot Robot"
                        >
                            (4) Control - An example interface using the Megabot Robot
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-05-22T17:12:21-07:00">
	
		    May 22, 2022
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/RB5_Robotics_Tutorials/categories/3-Robotics-Applications/">3 Robotics Applications</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>As we described in our previous tutorial on <a href="https://autonomousvehiclelaboratory.github.io/RB5_Robotics_Tutorials/2022/05/18/2%20Accessing%20Devices/building-and-loading-kernel-modules/">building and loading kernel modules on the RB5</a>, the Ubuntu 18.04 installation that is part of the RB5 LU build includes minimal package support to reduce OS complexity. With this in mind, if we wish to install custom drivers, we need to perform the process described. Thankfully, if you have build and loaded the kernel modules described in our tutorial, you will be able to interface with a standard joystick controller over USB and serial over USB.</p>
<p>With the preliminaries completed, we will use the <a target="_blank" rel="noopener" href="https://store.makeblock.com/products/makeblock-mbot-mega-robot-kit">Megabot Robot</a> as an example to interface with an RB5. In this case, we will use the <code>megapi</code> Python module designed for the Megabot to communite with the robot. This can be readily installed using <code>pip install megapi</code>.</p>
<p>Here we define a set of primitive actions that can control this four-mechanum-wheel robot. The set of primitive control actions include move <code>left</code>,<code>right</code>,<code>forward</code>, <code>in reverse</code>, rotate <code>clockwise</code>, <code>counter-clockwise</code>, and <code>stop</code>. Yes, it come as a surprise to many but the wheels on the robot contain a number of different rollers that ultimately influence the kinematics of the robot and jointly provide very interesting properties such as rotating in place and moving sideways!</p>
<p>The inverse kinematics of the robot can be described below.</p>
<div class="figure " style="width:;"><img class="fig-img" src="inverse.png" alt="Inverse kinematics"><span class="caption">Inverse kinematics</span></div>




<p>The following code snippet implements the control conditions for each of the actions defined. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">move</span>(<span class="params">self, direction, speed</span>):</span><br><span class="line">    <span class="comment"># port1: front right (wheel 1)</span></span><br><span class="line">    <span class="comment"># port2: rear left (wheel 0)</span></span><br><span class="line">    <span class="comment"># port9: rear right (wheel 3)</span></span><br><span class="line">    <span class="comment"># port10: front left (wheel 2)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> direction == <span class="string">&quot;left&quot;</span>:</span><br><span class="line">        <span class="comment"># fl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">10</span>, speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># fr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">1</span>, speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">2</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">9</span>, -speed)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">elif</span> direction == <span class="string">&quot;right&quot;</span>:</span><br><span class="line">        <span class="comment"># fl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">10</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># fr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">1</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">2</span>, speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">9</span>, speed)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">elif</span> direction == <span class="string">&quot;forward&quot;</span>:</span><br><span class="line">        <span class="comment"># fl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">10</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># fr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">1</span>, speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">2</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">9</span>, speed)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">elif</span> direction == <span class="string">&quot;reverse&quot;</span>:</span><br><span class="line">        <span class="comment"># fl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">10</span>, speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># fr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">1</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">2</span>, speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">9</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">elif</span> direction == <span class="string">&quot;ccwise&quot;</span>:</span><br><span class="line">        <span class="comment"># fl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">10</span>, speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># fr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">1</span>, speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">2</span>, speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">9</span>, speed)</span><br><span class="line">    <span class="keyword">elif</span> direction == <span class="string">&quot;cwise&quot;</span>:</span><br><span class="line">        <span class="comment"># fl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">10</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># fr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">1</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">2</span>, -speed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">9</span>, -speed)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># fl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">10</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># fr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rl wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">2</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># rr wheel</span></span><br><span class="line">        self.bot.motorRun(<span class="number">9</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>This script has been implemented using ROS1 and ROS2. While the robot can be controlled using the standard <code>joy</code> node using an USB jostick controller, it can additionally be controlled a standard ROS message for higher level planning strategies. The process of building and running the ROS nodes is outlined below.</p>
<h2 id="ROS1"><a href="#ROS1" class="headerlink" title="ROS1"></a>ROS1</h2><p>Create a workspace, clone the ROS1 implementation, and build the package. Make sure ROS is in your path, i.e. <code>source /opt/ros/melodic/setup.bash</code>. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p rb5_ws/src &amp;&amp; cd rb5_ws/src</span><br><span class="line">git clone https://github.com/AutonomousVehicleLaboratory/rb5_ros.git</span><br><span class="line">cd ..</span><br><span class="line">catkin_make</span><br><span class="line">source rb5_ws/devel/setup.bash </span><br></pre></td></tr></table></figure>

<p>Start the control node</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros run rb5_control rb5_mpi_control.py</span><br></pre></td></tr></table></figure>



<h2 id="ROS2"><a href="#ROS2" class="headerlink" title="ROS2"></a>ROS2</h2><p>Create a workspace, clone the ROS2 implementation, and build the package. Make sure ROS is in your path, i.e. <code>source /opt/ros/dashing/setup.bash</code>. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p rb5_ws/src &amp;&amp; cd rb5_ws/src</span><br><span class="line">git clone https://github.com/AutonomousVehicleLaboratory/rb5_ros2.git</span><br><span class="line">cd ..</span><br><span class="line">colcon build</span><br><span class="line">source rb5_ws/install/setup.bash </span><br></pre></td></tr></table></figure>

<p>Start the control node</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 run rb5_ros2_control rb5_mpi_control.py</span><br></pre></td></tr></table></figure>

<h2 id="MegaBot"><a href="#MegaBot" class="headerlink" title="MegaBot"></a>MegaBot</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/6Saki1CPfiA" frameborder="0" loading="lazy" allowfullscreen></iframe></div>


<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3>
                    
                        


                    
                    
                        <p>
                            <a
                                href="/RB5_Robotics_Tutorials/2022/05/22/3%20Robotics%20Applications/control-example-interface/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2022 RB5 ROBOTICS TUTORIALS. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/RB5_Robotics_Tutorials/assets/images/avl-letters.png" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">RB5 ROBOTICS TUTORIALS</h4>
        
            <div id="about-card-bio"><p>A set of Robotics Tutorials developed for the RB5 Robotics Development Platform from Qualcomm. Authors are from the Contextual Robotics Institute at UC San Diego.</p>
</div>
        
        
            <div id="about-card-bio">
                <p>Contributors</p>

                <!-- <i class="fa fa-briefcase"></i>
                <br/> -->
                <p>Henrik I. Christensen, David Paz, Henry Zhang, Anirudh Ramesh.</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/RB5_Robotics_Tutorials/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/RB5_Robotics_Tutorials/assets/js/script-ouavugrvd9qj6lg3dktmularsze8hx0ahydxl4n9zvn5qystucng5rouil06.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
